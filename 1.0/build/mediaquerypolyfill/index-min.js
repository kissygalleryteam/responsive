/*! responsive - v1.0 - 2013-05-14 2:38:06 PM
* Copyright (c) 2013 妙净、墨峰等; Licensed  */
KISSY.add("gallery/responsive/1.0/respondtools/index",function(){"use strict";function e(e){if(window.matchMedia&window.matchMedia("only all").matches)return window.matchMedia(e).matches;var t,i,n=document.documentElement.clientWidth;return t=e.replace(/.*min-width[\:\s]+(\d+)px.*/gi,"$1"),i=e.replace(/.*max-width[\:\s]+(\d+)px.*/gi,"$1"),t=/width/.test(t)?0:t,i=/width/.test(i)?0:i,i?n>=t&&i>=n:n>=t}window.matchMedia=window.matchMedia||function(e){var t,i=e.documentElement,n=i.firstElementChild||i.firstChild,a=e.createElement("body"),d=e.createElement("div");return d.id="mq-test-1",d.style.cssText="position:absolute;top:-100em",a.style.background="none",a.appendChild(d),function(e){return d.innerHTML='&shy;<style media="'+e+'"> #mq-test-1 { width: 42px; }</style>',i.insertBefore(a,n),t=42===d.offsetWidth,i.removeChild(a),{matches:t,media:e}}}(document);var t={match:window.matchMedia,wave:e};return t}),KISSY.add("gallery/responsive/1.0/mediaquerypolyfill/index",function(e,t,i){"use strict";function n(e){var t=this;n.superclass.constructor.call(t,e),t.init()}return n.ATTRS={breakpoints:{value:[750,1010,1220]},listeners:{},isAutoExectListener:{value:!0},isSupportMediaquery:{value:window.matchMedia&&window.matchMedia("only all").matches},isSupportAddListener:{value:window.matchMedia&&!!window.matchMedia("only all").addListener},viewportWidth:{value:0,getter:function(){return document.documentElement.clientWidth}}},e.extend(n,i,{init:function(){var t,i=this;!i.get("isSupportMediaquery")&&i._changeHtmlClass(),i.get("isSupportAddListener")?i._addNativeListener():i.get("isAutoExectListener")&&i._addListenerPolyfill(),window.onresize=function(){t&&t.cancel(),t=e.later(i._resizeHandler,500,!1,i)}},_resizeHandler:function(){var t=this;t.get("isSupportMediaquery")||t._changeHtmlClass(),t.get("isSupportAddListener")||(e.log("exect _addListenerPolyfill"),t._addListenerPolyfill())},_addNativeListener:function(){var e=this,t=e.get("listeners"),i=e.get("isAutoExectListener"),n={};for(var a in t){var d=window.matchMedia(a);n[d.media]=t[a],i&&d.matches&&t[a](),d.addListener(function(e){e.matches&&n[e.media]()})}},_addListenerPolyfill:function(){var i=this,n=i.get("listeners");for(var a in n)t.wave(a)&&(n[a](),e.log("callback"))},_replaceClass:function(e,t,i){e=e.split(/\s+/);for(var n=0;e.length>n;)e[n].match(t)?e.splice(n,1):n++;return e.push(i),e.join(" ")},_changeHtmlClass:function(){for(var e=this,t=e.get("breakpoints"),i=t.length,n=e.get("viewportWidth"),a=t[i-1],d=0;i>d;d++){var s=0>d-1?0:d-1;if(t[d]>n){a=t[s];break}}document.documentElement.className=e._replaceClass(document.documentElement.className,/vw\d+/,"vw"+a)}}),n},{requires:["../respondtools/index","base"]});