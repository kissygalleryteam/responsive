/*! responsive - v1.0 - 2013-05-20 5:17:09 PM
* Copyright (c) 2013 妙净、墨峰等; Licensed  */
KISSY.add("gallery/responsive/1.0/respondtools/index",function(S){"use strict";var matchMedia=window.matchMedia=window.matchMedia||function(e){var t,i=e.documentElement,n=i.firstElementChild||i.firstChild,r=e.createElement("body"),d=e.createElement("div");return d.id="mq-test-1",d.style.cssText="position:absolute;top:-100em",r.style.background="none",r.appendChild(d),function(e){return d.innerHTML='&shy;<style media="'+e+'"> #mq-test-1 { width: 42px; }</style>',i.insertBefore(r,n),t=42===d.offsetWidth,i.removeChild(r),{matches:t,media:e}}}(document),isSupportMediaquery=window.matchMedia&&window.matchMedia("only all").matches,wave=function(mediaquery){if(isSupportMediaquery)return window.matchMedia(mediaquery).matches;var min,max,docEl=document.documentElement,widthOrHeight=/width/.test(mediaquery)?"width":"height",viewportWidthOrHeight="width"==widthOrHeight?docEl.clientWidth:docEl.clientHeight;return min=mediaquery.replace(eval("/.*min-"+widthOrHeight+"[\\:\\s]+(\\d+)px.*/ig"),"$1"),max=mediaquery.replace(eval("/.*max-"+widthOrHeight+"[\\:\\s]+(\\d+)px.*/ig"),"$1"),min=/^\d/.test(min)?min:0,max=/^\d/.test(max)?max:0,max?viewportWidthOrHeight>=min&&max>=viewportWidthOrHeight:viewportWidthOrHeight>=min},RespondTools={isSupportMediaquery:isSupportMediaquery,matchMedia:S.bind(matchMedia,window),wave:wave};return RespondTools}),KISSY.add("gallery/responsive/1.0/mediaquerypolyfill/index",function(e,t,i){"use strict";function n(e){var t=this;e={breakpoints:e},n.superclass.constructor.call(t,e),t.init()}return n.ATTRS={breakpoints:{value:[750,1010,1220]},listeners:{value:{},setter:function(t){var i=this.get("listeners");for(var n in t)if(t.hasOwnProperty(n)){var r=i[n];if(e.isArray(r))r.push(t[n]);else{var d=[];d.push(t[n]),e.isFunction(r)&&d.push(r),i[n]=d}}return i}},isSupportMediaquery:{value:t.isSupportMediaquery},isSupportAddListener:{value:window.matchMedia&&!!window.matchMedia("only all").addListener},viewportWidth:{value:0,getter:function(){return document.documentElement.clientWidth}}},e.extend(n,i,{init:function(){var e=this,t=e.get("listeners");if(!e.get("isSupportMediaquery")&&e._changeHtmlClass(),e.get("isSupportAddListener"))return e._addNativeListener(t),void 0;e._addListenerPolyfill(t);var i=document.documentElement,n=i.clientWidth,r=i.clientHeight;window.onresize=function(){(n!=i.clientWidth||r!=i.clientHeight)&&e._resizeHandler(),n=i.clientWidth,r=i.clientHeight}},addListener:function(e){var t=this;t.get("isSupportAddListener")?t._addNativeListener(e):t._addListenerPolyfill(e),t.set("listeners",e)},_resizeHandler:function(){var e=this;e.get("isSupportMediaquery")||e._changeHtmlClass(),e.get("isSupportAddListener")||e._addListenerPolyfill(e.get("listeners"))},_addNativeListener:function(e){var t={};for(var i in e){var n=window.matchMedia(i);t[n.media]=e[i],n.matches&&e[i](),n.addListener(function(e){e.matches&&t[e.media]()})}},_addListenerPolyfill:function(i){for(var n in i)if(t.wave(n)){var r=i[n];if(e.isFunction(r)&&r(),e.isArray(r))for(var d,a=0;d=r[a];a++)e.isFunction(r[a])&&r[a]()}},_replaceClass:function(e,t,i){e=e.split(/\s+/);for(var n=0;e.length>n;)e[n].match(t)?e.splice(n,1):n++;return e.push(i),e.join(" ")},_changeHtmlClass:function(){for(var e=this,t=e.get("breakpoints"),i=t.length,n=e.get("viewportWidth"),r=t[i-1],d=0;i>d;d++){var a=0>d-1?0:d-1;if(t[d]>n){r=t[a];break}}document.documentElement.className=e._replaceClass(document.documentElement.className,/w\d+/,"w"+r)}}),n},{requires:["../respondtools/index","base"]});